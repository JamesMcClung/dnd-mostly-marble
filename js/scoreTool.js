const ABILITIES=["Strength","Dexterity","Constitution","Intelligence","Wisdom","Charisma"],LEVEL="Level",MAX_POINTS=18;let MAX_TOTAL_ASIS=0,MAX_ASI=0;const MAX_SCORE=5,SCORES_NO_ASI=[-1,0,1,2,3],SCORE_COSTS=[0,1,2,4,6],MAX_SCORE_NO_ASI=Math.max(...SCORES_NO_ASI);let MAX_SCORE_ASI=-1;const MIN_SCORE=Math.min(...SCORES_NO_ASI);updateScores(document.getElementById("Level_slider"),!1);for(const a of ABILITIES)updateScores(document.getElementById(a+"_slider"),a==ABILITIES[ABILITIES.length-1]);function updateScores(t,e=!0){var n,o=t.id.split("_")[0],t=t.value;o==LEVEL?(n=getAsiAtLevel(document.getElementById(o+"_value").textContent=t),MAX_TOTAL_ASIS=n,MAX_ASI=n,MAX_SCORE_ASI=getMaxScorePossible(MAX_POINTS,MAX_TOTAL_ASIS),document.getElementById("score_tool_asis_max").textContent=MAX_TOTAL_ASIS):document.getElementById(o+"_value").textContent=formatScore(t),e&&updateDisplayAndMaxs()}function formatScore(t){return(t=Number(t))<=0?""+t:"+"+t}function getAsiAtLevel(t){return 19<=(t=Number(t))?5:Math.floor(t/4)}function updateDisplayAndMaxs(){var e=getSliderValues(),o=[0,0,0,0,0,0];for(let t=0;t<ABILITIES.length;t++)o[t]=getMinimumAsi(e[t]);var l=e.map(getPointCostUpperBound);let t=sum(o),S=sum(l);for(;S>MAX_POINTS&&t<MAX_TOTAL_ASIS;){var i=[];for(let t=0;t<ABILITIES.length;t++)i.push(getPotentialPointsForAbility(l[t],o[t]));let e=-1,n=0;for(let t=0;t<ABILITIES.length;t++){var r=i[t];0<r.length&&(r=r[r.length-1])>n&&(e=t,n=r)}o[e]+=1,l[e]-=i[e].pop(),t=sum(o),S=sum(l)}setDisplay(MAX_POINTS-S,MAX_TOTAL_ASIS-t);for(let t=0;t<ABILITIES.length;t++){var n=ABILITIES[t],s=(setSliderDisplay(n,l[t],o[t]),getMaxScorePossibleWithConversions(l,o,t));setSliderMaxScore(n,s)}}function getMinimumAsi(t){return Math.max(0,t-MAX_SCORE_NO_ASI)}function setDisplay(t,e){document.getElementById("score_tool_points").textContent=t,document.getElementById("score_tool_asis").textContent=e}function setSliderDisplay(t,e,n){document.getElementById(t+"_points").textContent=e,document.getElementById(t+"_asi").textContent=n}function setSliderMaxScore(t,e){var n=document.getElementById(t+"_slider"),o=(n.max=e,n.parentElement.clientWidth),e=(o-20)*(e-MIN_SCORE)/(MAX_SCORE_ASI-MIN_SCORE)+20;n.style.width=100*e/o+"%",n.value==n.max?(document.getElementById(t+"_label").style.fontWeight="bolder",document.getElementById(t+"_value").style.fontWeight="bolder"):(document.getElementById(t+"_label").style.fontWeight="normal",document.getElementById(t+"_value").style.fontWeight="normal")}function sum(t){return t.reduce((t,e)=>t+e,0)}function getSliderValues(){return ABILITIES.map(t=>Number(document.getElementById(t+"_slider").value))}function getPointCostUpperBound(e){for(let t=SCORES_NO_ASI.length-1;0<=t;t--)if(e>=SCORES_NO_ASI[t])return SCORE_COSTS[t]}function getPotentialPointsForAbility(e,t){var n=[];for(let t=1;SCORE_COSTS[t]<=e;t++){var o=SCORE_COSTS[t]-SCORE_COSTS[t-1];(2<=o||0<n.length)&&n.push(o)}t=MAX_ASI-t;return n.slice(-t)}function getPotentialPointsAndAsis(e,n,o){let l=MAX_TOTAL_ASIS-sum(n);var S=[[0,l]];if(0!=l){var i,r=[];for(let t=0;t<ABILITIES.length;t++)t!=o&&r.push(getPotentialPointsForAbility(e[t],n[t]));let t=0;for(;0<l;l--){let n=-1,o=0;for(let e=0;e<r.length;e++){const t=r[e];0<t.length&&(i=[t.length-1])>o&&(n=e,o=i)}0<=n&&(t+=r[n].pop(),S.push([t,l-1]))}}return S}function getMaxScorePossible(e,n){for(let t=SCORE_COSTS.length-1;0<=t;t--)if(e>=SCORE_COSTS[t])return Math.min(MAX_SCORE,SCORES_NO_ASI[t]+Math.min(n,MAX_ASI))}function getMaxScorePossibleWithConversions(t,e,n){var o,l,S=MAX_POINTS-sum(t);let i=-1;for([o,l]of getPotentialPointsAndAsis(t,e,n))i=Math.max(i,getMaxScorePossible(t[n]+S+o,e[n]+l));return i}