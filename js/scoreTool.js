const ABILITIES=["Strength","Dexterity","Constitution","Intelligence","Wisdom","Charisma"],MAX_POINTS=18,MAX_TOTAL_ASIS=0,MAX_ASI=0,MAX_SCORE=5,SCORES_NO_ASI=[-1,0,1,2,3],SCORE_COSTS=[0,1,2,4,6],MAX_SCORE_NO_ASI=Math.max(...SCORES_NO_ASI),MAX_SCORE_ASI=MAX_SCORE_NO_ASI+MAX_ASI,MIN_SCORE=Math.min(...SCORES_NO_ASI);for(const a of ABILITIES)updateScores(document.getElementById(a+"_slider"),a==ABILITIES[ABILITIES.length-1]);function updateScores(t,e=!0){var n=t.id.split("_")[0],t=t.value;document.getElementById(n+"_value").textContent=formatScore(t),e&&updateDisplayAndMaxs()}function formatScore(t){return(t=Number(t))<=0?""+t:"+"+t}function updateDisplayAndMaxs(){var e=getSliderValues(),o=[0,0,0,0,0,0];for(let t=0;t<ABILITIES.length;t++)o[t]=Math.max(0,e[t]-MAX_SCORE_NO_ASI);var S=e.map(getPointCostUpperBound);let t=sum(o),l=sum(S);for(;l>MAX_POINTS&&t<MAX_TOTAL_ASIS;){var i=[];for(let t=0;t<ABILITIES.length;t++)i.push(getPotentialPointsForAbility(S[t],o[t]));let e=-1,n=0;for(let t=0;t<ABILITIES.length;t++){var r=i[t];0<r.length&&(r=r[r.length-1])>n&&(e=t,n=r)}o[e]+=1,S[e]-=i[e].pop(),t=sum(o),l=sum(S)}setDisplay(MAX_POINTS-l,MAX_TOTAL_ASIS-t);for(let t=0;t<ABILITIES.length;t++){var n=ABILITIES[t],s=(setSliderDisplay(n,S[t],o[t]),getMaxScorePossibleWithConversions(S,o,t));setSliderMaxScore(n,s)}}function setDisplay(t,e){document.getElementById("score_tool_points").textContent=t,document.getElementById("score_tool_asis").textContent=e}function setSliderDisplay(t,e,n){document.getElementById(t+"_points").textContent=e,document.getElementById(t+"_asi").textContent=n}function setSliderMaxScore(t,e){var n=document.getElementById(t+"_slider"),o=(n.max=e,n.parentElement.clientWidth),e=(o-20)*(e-MIN_SCORE)/(MAX_SCORE_ASI-MIN_SCORE)+20;n.style.width=100*e/o+"%",n.value==n.max?(document.getElementById(t+"_label").style.fontWeight="bolder",document.getElementById(t+"_value").style.fontWeight="bolder"):(document.getElementById(t+"_label").style.fontWeight="normal",document.getElementById(t+"_value").style.fontWeight="normal")}function sum(t){return t.reduce((t,e)=>t+e,0)}function getSliderValues(){return ABILITIES.map(t=>Number(document.getElementById(t+"_slider").value))}function getPointCostUpperBound(e){for(let t=SCORES_NO_ASI.length-1;0<=t;t--)if(e>=SCORES_NO_ASI[t])return SCORE_COSTS[t]}function getPotentialPointsForAbility(t,e){var n=SCORE_COSTS.indexOf(t-e),o=[];for(let t=1;t<=n;t++){var S=SCORE_COSTS[t]-SCORE_COSTS[t-1];(2<=S||0<o.length)&&o.push(S)}t=MAX_ASI-e;return o.slice(-t)}function getPotentialPointsAndAsis(e,n,o){let S=MAX_TOTAL_ASIS-sum(n);var l=[[0,S]];if(0!=S){var i,r=[];for(let t=0;t<ABILITIES.length;t++)t!=o&&r.push(getPotentialPointsForAbility(e[t],n[t]));let t=0;for(;0<S;S--){let n=-1,o=0;for(let e=0;e<r.length;e++){const t=r[e];0<t.length&&(i=[t.length-1])>o&&(n=e,o=i)}0<=n&&(t+=r[n].pop(),l.push[[t,S-1]])}}return l}function getMaxScorePossible(e,n){for(let t=SCORE_COSTS.length-1;0<=t;t--)if(e>=SCORE_COSTS[t])return Math.min(MAX_SCORE,SCORES_NO_ASI[t]+Math.min(n,MAX_ASI))}function getMaxScorePossibleWithConversions(t,e,n){var o,S,l=MAX_POINTS-sum(t),i=MAX_TOTAL_ASIS-sum(e);let r=-1;for([o,S]of getPotentialPointsAndAsis(t,e,n))r=Math.max(r,getMaxScorePossible(t[n]+l+o,e[n]+i+S));return r}