let ABILITIES=["Strength","Dexterity","Constitution","Intelligence","Wisdom","Charisma"],LEVEL="Level",MAX_POINTS=18,MAX_TOTAL_ASIS=0,MAX_ASI=0,MAX_SCORE=5,SCORES_NO_ASI=[-1,0,1,2,3],SCORE_COSTS=[0,1,2,4,6],MAX_SCORE_NO_ASI=Math.max(...SCORES_NO_ASI),MAX_SCORE_ASI=-1,MIN_SCORE=Math.min(...SCORES_NO_ASI);updateScores(document.getElementById("Level_slider"),!1);for(let e of ABILITIES)updateScores(document.getElementById(e+"_slider"),e==ABILITIES[ABILITIES.length-1]);function updateScores(e,t=!0){let n=e.id.split("_")[0];var o;if(n==LEVEL&&(o=e.value,o=getAsiAtLevel(document.getElementById(n+"_value").textContent=o),MAX_TOTAL_ASIS=o,MAX_ASI=o,MAX_SCORE_ASI=getMaxScorePossible(MAX_POINTS,MAX_TOTAL_ASIS),document.getElementById("score_tool_asis_max").textContent=MAX_TOTAL_ASIS),t&&updateDisplayAndMaxs(),n!=LEVEL)document.getElementById(n+"_value").textContent=formatScore(e.value);else for(let e of ABILITIES)updateScores(document.getElementById(e+"_slider"),e==ABILITIES[ABILITIES.length-1])}function formatScore(e){return(e=Number(e))<=0?""+e:"+"+e}function getAsiAtLevel(e){return 19<=(e=Number(e))?5:Math.floor(e/4)}function updateDisplayAndMaxs(){var t=getSliderValues(),o=[0,0,0,0,0,0];for(let e=0;e<ABILITIES.length;e++)o[e]=getMinimumAsi(t[e]);var l=t.map(getPointCostUpperBound);let e=sum(o),S=sum(l);for(;S>MAX_POINTS&&e<MAX_TOTAL_ASIS;){var i=[];for(let e=0;e<ABILITIES.length;e++)i.push(getPotentialPointsForAbility(l[e],o[e]));let t=-1,n=0;for(let e=0;e<ABILITIES.length;e++){var r=i[e];0<r.length&&(r=r[r.length-1])>n&&(t=e,n=r)}o[t]+=1,l[t]-=i[t].pop(),e=sum(o),S=sum(l)}setDisplay(MAX_POINTS-S,MAX_TOTAL_ASIS-e);for(let e=0;e<ABILITIES.length;e++){var n=ABILITIES[e],I=(setSliderDisplay(n,l[e],o[e]),getMaxScorePossibleWithConversions(l,o,e));setSliderMaxScore(n,I)}}function getMinimumAsi(e){return Math.max(0,e-MAX_SCORE_NO_ASI)}function setDisplay(e,t){document.getElementById("score_tool_points").textContent=e,document.getElementById("score_tool_asis").textContent=t}function setSliderDisplay(e,t,n){document.getElementById(e+"_points").textContent=t,document.getElementById(e+"_asi").textContent=n}function setSliderMaxScore(e,t){var n=document.getElementById(e+"_slider"),o=(n.max=t,n.parentElement.clientWidth),t=(o-20)*(t-MIN_SCORE)/(MAX_SCORE_ASI-MIN_SCORE)+20;n.style.width=100*t/o+"%",n.value==n.max?(document.getElementById(e+"_label").style.fontWeight="bolder",document.getElementById(e+"_value").style.fontWeight="bolder"):(document.getElementById(e+"_label").style.fontWeight="normal",document.getElementById(e+"_value").style.fontWeight="normal")}function sum(e){return e.reduce((e,t)=>e+t,0)}function getSliderValues(){return ABILITIES.map(e=>Number(document.getElementById(e+"_slider").value))}function getPointCostUpperBound(t){for(let e=SCORES_NO_ASI.length-1;0<=e;e--)if(t>=SCORES_NO_ASI[e])return SCORE_COSTS[e]}function getPotentialPointsForAbility(t,e){var n=[];for(let e=1;SCORE_COSTS[e]<=t;e++){var o=SCORE_COSTS[e]-SCORE_COSTS[e-1];(2<=o||0<n.length)&&n.push(o)}e=MAX_ASI-e;return n.slice(-e)}function getPotentialPointsAndAsis(t,n,o){let l=MAX_TOTAL_ASIS-sum(n);var S=[[0,l]];if(0!=l){var i,r=[];for(let e=0;e<ABILITIES.length;e++)e!=o&&r.push(getPotentialPointsForAbility(t[e],n[e]));let e=0;for(;0<l;l--){let n=-1,o=0;for(let t=0;t<r.length;t++){let e=r[t];0<e.length&&(i=[e.length-1])>o&&(n=t,o=i)}0<=n&&(e+=r[n].pop(),S.push([e,l-1]))}}return S}function getMaxScorePossible(t,n){for(let e=SCORE_COSTS.length-1;0<=e;e--)if(t>=SCORE_COSTS[e])return Math.min(MAX_SCORE,SCORES_NO_ASI[e]+Math.min(n,MAX_ASI))}function getMaxScorePossibleWithConversions(e,t,n){var o,l,S=MAX_POINTS-sum(e);let i=-1;for([o,l]of getPotentialPointsAndAsis(e,t,n))i=Math.max(i,getMaxScorePossible(e[n]+S+o,t[n]+l));return i}