function toggleSearch(e,t,s){consumeEvent(s);s=e.rows[0].getElementsByTagName("th")[t],s.getElementsByClassName("col-title")[0].classList.toggle("displaynone"),e=s.getElementsByClassName("searchbar")[0];(e.classList.toggle("displaynone")?s.querySelector("searchbutton"):e).focus()}function consumeEvent(e){e.stopPropagation()}function popupSearch(e,t){var e=e.getElementsByClassName("popupAnchor"),s="string"==typeof t?e=>e.toLowerCase().includes(t):e=>t.exec(e);if(0<e.length)for(const a of document.getElementById(e[0].dataset.popupId).innerHTML.split(/<(?!\/?(?:i|b|a|s|span|mark)\b)[^>]*>/i).map(e=>e.trim()).filter(e=>0<e.length).map(e=>e.replace(/<[^>]*>/g,"")))if(s(a))return!0;return!1}let lastSearch="";function updateFilter(e,a,t,l){if("Escape"===l.key)toggleSearch(e,a,l);else{let s=t.value;if(s!==lastSearch){var n=(lastSearch=s).startsWith("$"),l=(s=n?s.slice(1):s).lastIndexOf("/"),o=s.startsWith("/")&&0<l;s=o?RegExp(s.slice(1,l),s.slice(l+1)):s.toLowerCase();for(const r of Array.prototype.slice.call(e.rows,1)){let t;if(n)t=popupSearch(r.children[a],s);else{let e=r.children[a].innerText;t=o?!!s.exec(e):(e=e.toLowerCase()).includes(s)||"0"==s&&e.includes("cantrip")}t?r.classList.remove("displaynone"+a):r.classList.add("displaynone"+a)}}}}