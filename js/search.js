function toggleSearch(e,t,s){consumeEvent(s);s=e.rows[0].getElementsByTagName("th")[t],s.getElementsByClassName("col-title")[0].classList.toggle("displaynone"),e=s.getElementsByClassName("searchbar")[0];(e.classList.toggle("displaynone")?s.getElementsByClassName("searchbutton")[0]:e).focus()}function consumeEvent(e){e.stopPropagation()}function popupSearch(e,t){anchors=e.getElementsByClassName("popupAnchor");var s="string"==typeof t?e=>e.toLowerCase().includes(t):e=>t.exec(e);if(0<anchors.length)for(const a of document.getElementById(anchors[0].onclick.toString().match(/popup\d+/)[0]).innerHTML.split(/<(?!\/?(?:i|b|a|s|span|mark)\b)[^>]*>/i).map(e=>e.trim()).filter(e=>0<e.length).map(e=>e.replace(/<[^>]*>/g,"")))if(s(a))return!0;return!1}let lastSearch="";function updateFilter(e,a,t,n){if("Escape"===n.key)toggleSearch(e,a,n);else{let s=t.value;if(s!==lastSearch){var l=(lastSearch=s).startsWith("$"),n=(s=l?s.slice(1):s).lastIndexOf("/"),o=s.startsWith("/")&&0<n;s=o?RegExp(s.slice(1,n),s.slice(n+1)):s.toLowerCase();for(const c of Array.prototype.slice.call(e.rows,1)){let t;if(l)t=popupSearch(c.children[a],s);else{let e=c.children[a].innerText;t=o?s.exec(e):(e=e.toLowerCase()).includes(s)||"0"==s&&e.includes("cantrip")}t?c.classList.remove("displaynone"+a):c.classList.add("displaynone"+a)}}}}