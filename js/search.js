function toggleSearch(e,t,s){s.stopPropagation();s=e.rows[0].getElementsByTagName("th")[t],s.getElementsByClassName("col-title")[0].classList.toggle("displaynone"),e=s.getElementsByClassName("searchbar")[0];(e.classList.toggle("displaynone")?s.getElementsByClassName("searchbutton")[0]:e).focus()}function popupSearch(e,t){var s,e=e.getElementsByClassName("popupAnchor"),a="string"==typeof t?e=>e.toLowerCase().includes(t):e=>t.exec(e);for(s of e){var l,r=s.dataset.injectionArg;for(l of window.POPUP_DATA[r].content_html.split(/<(?!\/?(?:i|b|a|s|span|mark)\b)[^>]*>/i).map(e=>e.trim()).filter(e=>0<e.length).map(e=>e.replace(/<[^>]*>/g,"")))if(a(l))return!0}return!1}let lastSearch="";function updateFilter(e,a,t,l){if("Escape"===l.key)toggleSearch(e,a,l);else{let s=t.value;if(s!==lastSearch){var r,o=(lastSearch=s).startsWith("$"),l=(s=o?s.slice(1):s).lastIndexOf("/"),n=s.startsWith("/")&&0<l;s=n?RegExp(s.slice(1,l),s.slice(l+1)):s.toLowerCase();for(r of Array.prototype.slice.call(e.rows,1)){let t;if(o)t=popupSearch(r.children[a],s);else{let e=r.children[a].innerText;t=n?!!s.exec(e):(e=e.toLowerCase()).includes(s)||"0"==s&&e.includes("cantrip")}t?r.classList.remove("displaynone"+a):r.classList.add("displaynone"+a)}}}}