function getClientCoords(e){return e.getBoundingClientRect()}function getPageCoords(e){e=e.getBoundingClientRect();return{top:e.top+window.pageYOffset,right:e.right+window.pageXOffset,bottom:e.bottom+window.pageYOffset,left:e.left+window.pageXOffset}}function setElementTopLeft(e,t){e.style.left=t.left+"px",e.style.top=t.top+"px"}function toggleFixedPosition(e,t={}){var o;t.event&&t.event.stopPropagation(),"fixed"==t.set||"absolute"!=t.set&&"fixed"!=e.style.position?(o=getClientCoords(e),e.style.position="fixed",setElementTopLeft(e,o),e.querySelector(".popupHeader").querySelector(".popupHeaderButtongroup").querySelector(".popupHeaderButtonSticky").innerHTML="&#9679;"):"absolute"!=t.set&&"absolute"==e.style.position||(o=getPageCoords(e),e.style.position="absolute",setElementTopLeft(e,o),e.querySelector(".popupHeader").querySelector(".popupHeaderButtongroup").querySelector(".popupHeaderButtonSticky").innerHTML="&#9675;")}function sendToTop(e){var t,o,n=document.getElementsByTagName("article")[0];n.lastChild!==e&&(o=(t=e.querySelector(".popupContent")).firstElementChild.scrollTop,n.append(e),t.firstElementChild.scrollTop=o)}function getAdjustedY(e,t){return e<t?t:e}function toggleDragEnabled(n,e={}){e.event&&e.event.stopPropagation();let s,l,i,p=-1,r=-1,d=!1;const t=n.querySelector(".popupHeader");function o(e){var t=e.clientX-l,o=getAdjustedY(e.clientY,s)-i,e=(l=e.clientX,i=getAdjustedY(e.clientY,s),getClientCoords(n));n.style.top=n.offsetTop+o+"px",e.left+t<=0||0<r&&p+t<r?(p<0&&(p=r=e.right),p+=t,n.style.right=screen.width-p+"px",n.style.removeProperty("left")):(n.style.left=n.offsetLeft+t+"px",n.style.removeProperty("right"),p=r=-1),d|=0!=t||0!=o}function u(){t.onmouseup=null,document.onmouseup=null,document.onmousemove=null,d||(n.classList.contains("isCollapsed")?n.classList.remove("isCollapsed"):n.classList.add("isCollapsed")),d=!1}n.onclick=e=>{sendToTop(n),e.stopPropagation()},t.onmousedown?(t.onmousedown=null,toggleFixedPosition(n,{set:"absolute"}),n.classList.remove("dragEnabled"),n.classList.remove("isCollapsed"),e=getPageCoords(e.event.target),setElementTopLeft(n,{left:e.left,top:e.bottom}),n.style.removeProperty("right")):(setElementTopLeft(n,getPageCoords(n)),sendToTop(n),t.onmousedown=function(e){s=document.getElementsByTagName("header")[0].getBoundingClientRect().bottom+e.clientY-getClientCoords(n).top,l=e.clientX,i=getAdjustedY(e.clientY,s),t.onmouseup=u,document.onmouseup=u,document.onmousemove=o,sendToTop(n)},n.classList.add("dragEnabled"))}function showPopup(e,t){sendToTop(e),e.classList.add("visible"),e.classList.contains("dragEnabled")||setElementTopLeft(e,{left:(e=getPageCoords(t)).left,top:e.bottom})}function hidePopup(e){e.classList.remove("visible")}